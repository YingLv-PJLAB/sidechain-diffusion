WARNING:root:Removing old results directory: /nvme/lvying/code/test1-GraphDiff/bin/results
INFO:root:Writing training args to /nvme/lvying/code/test1-GraphDiff/bin/results/training_args.json
INFO:root:Training argument: results_dir=/nvme/lvying/code/test1-GraphDiff/bin/results
INFO:root:Training argument: dataset_key=cath
INFO:root:Training argument: angles_definitions=canonical-full-angles
INFO:root:Training argument: max_seq_len=128
INFO:root:Training argument: min_seq_len=40
INFO:root:Training argument: trim_strategy=randomcrop
INFO:root:Training argument: timesteps=1000
INFO:root:Training argument: variance_schedule=cosine
INFO:root:Training argument: variance_scale=1.0
INFO:root:Training argument: time_encoding=gaussian_fourier
INFO:root:Training argument: num_hidden_layers=12
INFO:root:Training argument: hidden_size=384
INFO:root:Training argument: intermediate_size=768
INFO:root:Training argument: num_heads=12
INFO:root:Training argument: position_embedding_type=relative_key
INFO:root:Training argument: dropout_p=0.1
INFO:root:Training argument: decoder=mlp
INFO:root:Training argument: gradient_clip=1.0
INFO:root:Training argument: batch_size=64
INFO:root:Training argument: lr=0.005
INFO:root:Training argument: loss=smooth_l1
INFO:root:Training argument: use_pdist_loss=0.0
INFO:root:Training argument: l2_norm=0.0
INFO:root:Training argument: l1_norm=0.0
INFO:root:Training argument: circle_reg=0.0
INFO:root:Training argument: min_epochs=10000
INFO:root:Training argument: max_epochs=10000
INFO:root:Training argument: early_stop_patience=0
INFO:root:Training argument: lr_scheduler=LinearWarmup
INFO:root:Training argument: use_swa=False
INFO:root:Training argument: subset=None
INFO:root:Training argument: exhaustive_validation_t=False
INFO:root:Training argument: syn_noiser=
INFO:root:Training argument: single_angle_debug=-1
INFO:root:Training argument: single_timestep_debug=False
INFO:root:Training argument: cpu_only=False
INFO:root:Training argument: ngpu=-1
INFO:root:Training argument: write_valid_preds=False
INFO:root:Training argument: dryrun=True
INFO:root:Training argument: multithread=True
INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
WARNING:root:Mismatched hashes between codebase and cached values; updating cached values
INFO:root:Computing full dataset of 31885 with 128 threads
WARNING:root:Illegal values for omega in /nvme/lvying/code/test1-GraphDiff/data/cath/dompdb/2ebqA00 -- skipping
WARNING:root:Illegal values for omega in /nvme/lvying/code/test1-GraphDiff/data/cath/dompdb/1x5bA01 -- skipping
WARNING:root:Illegal values for psi in /nvme/lvying/code/test1-GraphDiff/data/cath/dompdb/1awoA00 -- skipping
WARNING:root:Illegal values for omega in /nvme/lvying/code/test1-GraphDiff/data/cath/dompdb/5a2qw00 -- skipping
INFO:root:Saving full dataset to cache at /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Length of angles: 40-1202, mean 153.65002467511104
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.327174    1.4532878   1.5188155  -1.4729365   0.04874657  3.12762
  1.940609    2.0352798   2.122644  ]
INFO:root:Length of angles: 40-1146, mean 153.68377755840737
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272083   1.4533216   1.5186924  -1.4746895   0.08512627  3.127784
  1.940425    2.0353124   2.1227002 ]
INFO:root:Length of angles: 40-747, mean 150.6845394736842
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f70c087bbb0> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f70c0909b20> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f70c0909a30> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
Given batch size: 64 --> effective batch size with 8 GPUs: 8
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmp1l5r76h_
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmp1l5r76h_/_remote_module_non_scriptable.py
Using time embedding: GaussianFourierProjection()
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
Using loss: [functools.partial(<function radian_smooth_l1_loss at 0x7f70c83428b0>, beta=0.3141592653589793), functools.partial(<function radian_smooth_l1_loss at 0x7f70c83428b0>, beta=0.3141592653589793), functools.partial(<function radian_smooth_l1_loss at 0x7f70c83428b0>, beta=0.3141592653589793), functools.partial(<function radian_smooth_l1_loss at 0x7f70c83428b0>, beta=0.3141592653589793), functools.partial(<function radian_smooth_l1_loss at 0x7f70c83428b0>, beta=0.3141592653589793), functools.partial(<function radian_smooth_l1_loss at 0x7f70c83428b0>, beta=0.3141592653589793)]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f70c0756490>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f70c0756460>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7f70af8c1160>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7f70af8c1790>
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Length of angles: 40-1202, mean 153.65002467511104
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Length of angles: 40-1202, mean 153.65002467511104
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:Length of angles: 40-1202, mean 153.65002467511104
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.327174    1.4532878   1.5188155  -1.4729365   0.04874657  3.12762
  1.940609    2.0352798   2.122644  ]
INFO:root:Length of angles: 40-1146, mean 153.68377755840737
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.327174    1.4532878   1.5188155  -1.4729365   0.04874657  3.12762
  1.940609    2.0352798   2.122644  ]
INFO:root:Length of angles: 40-1146, mean 153.68377755840737
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Length of angles: 40-1202, mean 153.65002467511104
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Length of angles: 40-1202, mean 153.65002467511104
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.327174    1.4532878   1.5188155  -1.4729365   0.04874657  3.12762
  1.940609    2.0352798   2.122644  ]
INFO:root:Length of angles: 40-1146, mean 153.68377755840737
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272083   1.4533216   1.5186924  -1.4746895   0.08512627  3.127784
  1.940425    2.0353124   2.1227002 ]
INFO:root:Length of angles: 40-747, mean 150.6845394736842
INFO:root:Clean dataset class: <class 'foldingdiff.datasets.CathCanonicalAnglesOnlyDataset'>
INFO:root:Creating data splits: ['train', 'validation', 'test']
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f6d67e8aa60> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f6d67e8ab20> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f6d67e8aac0> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmpy4sag55c
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmpy4sag55c/_remote_module_non_scriptable.py
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f6d67de15e0>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f6d67de1850>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7f6d614df790>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7f6d614dfa90>
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/8
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272083   1.4533216   1.5186924  -1.4746895   0.08512627  3.127784
  1.940425    2.0353124   2.1227002 ]
INFO:root:Length of angles: 40-747, mean 150.6845394736842
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f36d604fd00> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f36d70e2340> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f36d70e2130> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmpem4hne_o
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmpem4hne_o/_remote_module_non_scriptable.py
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f36cf51bd60>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f36cf51b250>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7f36cf6ad820>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7f36cf6ad7c0>
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/8
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/8
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 2
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 1
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.327174    1.4532878   1.5188155  -1.4729365   0.04874657  3.12762
  1.940609    2.0352798   2.122644  ]
INFO:root:Length of angles: 40-1146, mean 153.68377755840737
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Length of angles: 40-1202, mean 153.65002467511104
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272083   1.4533216   1.5186924  -1.4746895   0.08512627  3.127784
  1.940425    2.0353124   2.1227002 ]
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.327174    1.4532878   1.5188155  -1.4729365   0.04874657  3.12762
  1.940609    2.0352798   2.122644  ]
INFO:root:Length of angles: 40-747, mean 150.6845394736842
INFO:root:Length of angles: 40-1146, mean 153.68377755840737
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7fe5fbfa2f10> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7fe5fd033370> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7fe5fd033160> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmpwhfx3_af
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmpwhfx3_af/_remote_module_non_scriptable.py
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7fe5f546fdf0>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7fe5f546fc10>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7fe5f56029a0>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7fe5f5602b80>
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/8
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 3
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split train contains 24316 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Length of angles: 40-1202, mean 153.65002467511104
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272083   1.4533216   1.5186924  -1.4746895   0.08512627  3.127784
  1.940425    2.0353124   2.1227002 ]
INFO:root:Length of angles: 40-747, mean 150.6845394736842
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f3890273a60> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f3891306340> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f3891306130> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmp41ze0oc5
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmp41ze0oc5/_remote_module_non_scriptable.py
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f3889740ca0>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f3889740190>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7f38898d22e0>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7f38898d2430>
Initializing distributed: GLOBAL_RANK: 4, MEMBER: 5/8
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 4
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.327174    1.4532878   1.5188155  -1.4729365   0.04874657  3.12762
  1.940609    2.0352798   2.122644  ]
INFO:root:Length of angles: 40-1146, mean 153.68377755840737
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272083   1.4533216   1.5186924  -1.4746895   0.08512627  3.127784
  1.940425    2.0353124   2.1227002 ]
INFO:root:Length of angles: 40-747, mean 150.6845394736842
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7ff9e0b1baf0> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7ff9e1c5b370> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7ff9e1c5b160> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmpoev157vg
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmpoev157vg/_remote_module_non_scriptable.py
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7ff9d9d42eb0>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7ff9e0b1bfa0>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7ff9da213d90>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7ff9da22b250>
Initializing distributed: GLOBAL_RANK: 5, MEMBER: 6/8
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 5
INFO:torch.distributed.distributed_c10d:Waiting in store based barrier to initialize process group for rank: 2, key: store_based_barrier_key:1 (world_size=8, worker_count=5, timeout=0:30:00)
INFO:torch.distributed.distributed_c10d:Waiting in store based barrier to initialize process group for rank: 1, key: store_based_barrier_key:1 (world_size=8, worker_count=5, timeout=0:30:00)
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split validation contains 3039 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.327174    1.4532878   1.5188155  -1.4729365   0.04874657  3.12762
  1.940609    2.0352798   2.122644  ]
INFO:root:Length of angles: 40-1146, mean 153.68377755840737
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Loading cached full dataset from /nvme/lvying/code/test1-GraphDiff/foldingdiff/cache_canonical_structures_cath_6ae68065b7f0987ba18bb039780eeb55.pkl
INFO:torch.distributed.distributed_c10d:Waiting in store based barrier to initialize process group for rank: 3, key: store_based_barrier_key:1 (world_size=8, worker_count=5, timeout=0:30:00)
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272083   1.4533216   1.5186924  -1.4746895   0.08512627  3.127784
  1.940425    2.0353124   2.1227002 ]
INFO:root:Length of angles: 40-747, mean 150.6845394736842
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7faf07b02b80> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7faf07b02970> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7faf07b02a90> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmpsj366op9
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmpsj366op9/_remote_module_non_scriptable.py
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7faf00fcb460>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7faf00fcb370>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7faf01159e80>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7faf01159550>
Initializing distributed: GLOBAL_RANK: 6, MEMBER: 7/8
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 6
INFO:torch.distributed.distributed_c10d:Waiting in store based barrier to initialize process group for rank: 4, key: store_based_barrier_key:1 (world_size=8, worker_count=6, timeout=0:30:00)
INFO:root:Hash matches between codebase and cached values!
INFO:root:Removing structures shorter than 40 residues excludes 536/30931 --> 30395 sequences
INFO:root:Split test contains 3040 structures
INFO:root:Offsetting features ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] by means [ 1.3272083   1.4533216   1.5186924  -1.4746895   0.08512627  3.127784
  1.940425    2.0353124   2.1227002 ]
INFO:root:Length of angles: 40-747, mean 150.6845394736842
INFO:root:CATH canonical angles only dataset with ['phi', 'psi', 'omega', 'tau', 'CA:C:1N', 'C:1N:1CA'] (subset idx [3, 4, 5, 6, 7, 8])
INFO:root:Updating valid/test mean offset to [ 1.3271055   1.4533105   1.5187992  -1.4703655   0.03479893  3.1276426
  1.9404638   2.0354066   2.1225426 ]
INFO:root:Using <class 'foldingdiff.datasets.NoisedAnglesDataset'> for noise
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:Getting cosine variance schedule with 1000 timesteps
INFO:root:train: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f62c24aeb20> with 24316 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:validation: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f62c24aeb80> with 3039 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:test: NoisedAnglesDataset wrapping <foldingdiff.datasets.CathCanonicalAnglesOnlyDataset object at 0x7f62c24ae820> with 3040 examples with cosine-1000 with variance scales 1.0 and 1.0
INFO:root:Using loss function: smooth_l1
INFO:root:Auto detected 6 inputs
INFO:torch.distributed.nn.jit.instantiator:Created a temporary directory at /tmp/tmpzsmrsi54
INFO:torch.distributed.nn.jit.instantiator:Writing /tmp/tmpzsmrsi54/_remote_module_non_scriptable.py
INFO:root:Mapping loss smooth_l1 to list of losses corresponding to angular [True, True, True, True, True, True]
INFO:root:Model callbacks: [<pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f62bb9760d0>, <pytorch_lightning.callbacks.model_checkpoint.ModelCheckpoint object at 0x7f62bb976100>, <pytorch_lightning.callbacks.lr_monitor.LearningRateMonitor object at 0x7f62bbb0c550>]
INFO:root:Using cuda with strategy <pytorch_lightning.strategies.ddp.DDPStrategy object at 0x7f62bbb0c910>
Initializing distributed: GLOBAL_RANK: 7, MEMBER: 8/8
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 7
INFO:torch.distributed.distributed_c10d:Added key: store_based_barrier_key:1 to store for rank: 0
INFO:torch.distributed.distributed_c10d:Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 8 processes
----------------------------------------------------------------------------------------------------

INFO:torch.distributed.distributed_c10d:Rank 6: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO:torch.distributed.distributed_c10d:Rank 7: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO:torch.distributed.distributed_c10d:Rank 2: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO:torch.distributed.distributed_c10d:Rank 3: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO:torch.distributed.distributed_c10d:Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO:torch.distributed.distributed_c10d:Rank 4: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
INFO:torch.distributed.distributed_c10d:Rank 5: Completed store-based barrier for key:store_based_barrier_key:1 with 8 nodes.
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 5 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 2 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 7 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 3 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 6 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
LOCAL_RANK: 4 - CUDA_VISIBLE_DEVICES: [0,1,2,3,4,5,6,7]
Using linear warmup with 1000/10000 warmup steps
Using optimizer {'optimizer': AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.005
    lr: 0.0
    maximize: False
    weight_decay: 0.0
), 'lr_scheduler': {'scheduler': <torch.optim.lr_scheduler.LambdaLR object at 0x7f70af78b130>, 'frequency': 1, 'interval': 'epoch'}}

  | Name                 | Type                      | Params
-------------------------------------------------------------------
0 | inputs_to_hidden_dim | Linear                    | 2.7 K 
1 | embeddings           | BertEmbeddings            | 768   
2 | encoder              | Struct2Seq                | 2.4 M 
3 | token_decoder        | AnglesPredictor           | 150 K 
4 | time_embed           | GaussianFourierProjection | 0     
-------------------------------------------------------------------
2.5 M     Trainable params
0         Non-trainable params
2.5 M     Total params
10.136    Total estimated model params size (MB)
model_size = 10.147144 M 

model_size = 10.147144 M 

model_size = 10.147144 M 

model_size = 10.147144 M 

model_size = 10.147144 M 

model_size = 10.147144 M 

model_size = 10.147144 M 

model_size = 10.147144 M 

Valid loss at epoch 0 end: 0.8094
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
INFO:torch.nn.parallel.distributed:Reducer buckets have been rebuilt in this iteration.
Valid loss at epoch 0 end: 0.8001
Train loss at epoch 0 end: 0.7987 (420.55 seconds)
Valid loss at epoch 1 end: 0.3041
Train loss at epoch 1 end: 0.3926 (354.61 seconds)
Valid loss at epoch 2 end: 0.2771
Train loss at epoch 2 end: 0.2866 (343.80 seconds)
Valid loss at epoch 3 end: 0.2118
Train loss at epoch 3 end: 0.2533 (340.81 seconds)
Valid loss at epoch 4 end: 0.1979
Train loss at epoch 4 end: 0.2221 (341.71 seconds)
Valid loss at epoch 5 end: 0.1740
Train loss at epoch 5 end: 0.2042 (342.46 seconds)
Valid loss at epoch 6 end: 0.1773
Train loss at epoch 6 end: 0.1906 (341.80 seconds)
Valid loss at epoch 7 end: 0.1634
Train loss at epoch 7 end: 0.1849 (343.08 seconds)
Valid loss at epoch 8 end: 0.1582
Train loss at epoch 8 end: 0.1746 (343.53 seconds)
Valid loss at epoch 9 end: 0.1483
Train loss at epoch 9 end: 0.1733 (343.83 seconds)
Valid loss at epoch 10 end: 0.1579
Train loss at epoch 10 end: 0.1674 (341.88 seconds)
Valid loss at epoch 11 end: 0.1484
Train loss at epoch 11 end: 0.1619 (349.43 seconds)
Valid loss at epoch 12 end: 0.1553
Train loss at epoch 12 end: 0.1625 (343.95 seconds)
Valid loss at epoch 13 end: 0.1470
Train loss at epoch 13 end: 0.1633 (343.01 seconds)
Valid loss at epoch 14 end: 0.1415
Train loss at epoch 14 end: 0.1575 (343.98 seconds)
Valid loss at epoch 15 end: 0.1507
Train loss at epoch 15 end: 0.1539 (340.47 seconds)
Valid loss at epoch 16 end: 0.1451
Train loss at epoch 16 end: 0.1584 (343.64 seconds)
Valid loss at epoch 17 end: 0.1456
Train loss at epoch 17 end: 0.1521 (350.22 seconds)
Valid loss at epoch 18 end: 0.1416
Train loss at epoch 18 end: 0.1516 (341.96 seconds)
Valid loss at epoch 19 end: 0.1416
Train loss at epoch 19 end: 0.1523 (347.47 seconds)
Valid loss at epoch 20 end: 0.1420
Train loss at epoch 20 end: 0.1513 (345.53 seconds)
Valid loss at epoch 21 end: 0.1384
Train loss at epoch 21 end: 0.1484 (347.15 seconds)
Valid loss at epoch 22 end: 0.1402
Train loss at epoch 22 end: 0.1470 (343.97 seconds)
Valid loss at epoch 23 end: 0.1325
Train loss at epoch 23 end: 0.1445 (347.09 seconds)
Valid loss at epoch 24 end: 0.1325
Train loss at epoch 24 end: 0.1471 (343.14 seconds)
Valid loss at epoch 25 end: 0.1354
Train loss at epoch 25 end: 0.1474 (341.32 seconds)
Valid loss at epoch 26 end: 0.1354
Train loss at epoch 26 end: 0.1506 (343.07 seconds)
Valid loss at epoch 27 end: 0.1383
Train loss at epoch 27 end: 0.1454 (349.53 seconds)
Valid loss at epoch 28 end: 0.1406
Train loss at epoch 28 end: 0.1437 (343.64 seconds)
Valid loss at epoch 29 end: 0.1321
Train loss at epoch 29 end: 0.1431 (342.21 seconds)
Valid loss at epoch 30 end: 0.1411
Train loss at epoch 30 end: 0.1423 (341.11 seconds)
Valid loss at epoch 31 end: 0.1379
Train loss at epoch 31 end: 0.1449 (341.07 seconds)
Valid loss at epoch 32 end: 0.1286
Train loss at epoch 32 end: 0.1404 (344.57 seconds)
Valid loss at epoch 33 end: 0.1345
Train loss at epoch 33 end: 0.1383 (342.74 seconds)
Valid loss at epoch 34 end: 0.1347
Train loss at epoch 34 end: 0.1432 (344.58 seconds)
Valid loss at epoch 35 end: 0.1324
Train loss at epoch 35 end: 0.1402 (344.03 seconds)
Valid loss at epoch 36 end: 0.1249
Train loss at epoch 36 end: 0.1413 (341.34 seconds)
Valid loss at epoch 37 end: 0.1247
Train loss at epoch 37 end: 0.1393 (344.54 seconds)
Valid loss at epoch 38 end: 0.1294
Train loss at epoch 38 end: 0.1394 (345.48 seconds)
Valid loss at epoch 39 end: 0.1336
Train loss at epoch 39 end: 0.1350 (340.92 seconds)
Valid loss at epoch 40 end: 0.1260
Train loss at epoch 40 end: 0.1387 (345.64 seconds)
Valid loss at epoch 41 end: 0.1263
Train loss at epoch 41 end: 0.1379 (342.99 seconds)
Valid loss at epoch 42 end: 0.1323
Train loss at epoch 42 end: 0.1383 (344.78 seconds)
Valid loss at epoch 43 end: 0.1304
Train loss at epoch 43 end: 0.1367 (343.13 seconds)
Valid loss at epoch 44 end: 0.1311
Train loss at epoch 44 end: 0.1369 (347.86 seconds)
Valid loss at epoch 45 end: 0.1373
Train loss at epoch 45 end: 0.1359 (341.93 seconds)
Valid loss at epoch 46 end: 0.1275
Train loss at epoch 46 end: 0.1372 (341.27 seconds)
Valid loss at epoch 47 end: 0.1368
Train loss at epoch 47 end: 0.1346 (343.91 seconds)
Valid loss at epoch 48 end: 0.1314
Train loss at epoch 48 end: 0.1330 (348.17 seconds)
Valid loss at epoch 49 end: 0.1236
Train loss at epoch 49 end: 0.1333 (342.24 seconds)
Valid loss at epoch 50 end: 0.1367
Train loss at epoch 50 end: 0.1405 (347.68 seconds)
Valid loss at epoch 51 end: 0.1339
Train loss at epoch 51 end: 0.1381 (342.11 seconds)
Valid loss at epoch 52 end: 0.1272
Train loss at epoch 52 end: 0.1329 (341.44 seconds)
Valid loss at epoch 53 end: 0.1371
Train loss at epoch 53 end: 0.1353 (343.83 seconds)
Valid loss at epoch 54 end: 0.1322
Train loss at epoch 54 end: 0.1353 (345.55 seconds)
Valid loss at epoch 55 end: 0.1291
Train loss at epoch 55 end: 0.1301 (345.62 seconds)
Valid loss at epoch 56 end: 0.1413
Train loss at epoch 56 end: 0.1314 (341.07 seconds)
Valid loss at epoch 57 end: 0.1341
Train loss at epoch 57 end: 0.1323 (344.20 seconds)
Valid loss at epoch 58 end: 0.1254
Train loss at epoch 58 end: 0.1325 (344.01 seconds)
Valid loss at epoch 59 end: 0.1215
Train loss at epoch 59 end: 0.1276 (345.40 seconds)
Valid loss at epoch 60 end: 0.1297
Train loss at epoch 60 end: 0.1301 (343.03 seconds)
Valid loss at epoch 61 end: 0.1324
Train loss at epoch 61 end: 0.1339 (341.41 seconds)
Valid loss at epoch 62 end: 0.1232
Train loss at epoch 62 end: 0.1328 (344.05 seconds)
Valid loss at epoch 63 end: 0.1324
Train loss at epoch 63 end: 0.1332 (342.32 seconds)
Valid loss at epoch 64 end: 0.1288
Train loss at epoch 64 end: 0.1328 (341.50 seconds)
Valid loss at epoch 65 end: 0.1295
Train loss at epoch 65 end: 0.1292 (347.04 seconds)
Valid loss at epoch 66 end: 0.1225
Train loss at epoch 66 end: 0.1328 (346.25 seconds)
Valid loss at epoch 67 end: 0.1167
Train loss at epoch 67 end: 0.1333 (343.66 seconds)
Valid loss at epoch 68 end: 0.1228
Train loss at epoch 68 end: 0.1299 (343.34 seconds)
Valid loss at epoch 69 end: 0.1266
Train loss at epoch 69 end: 0.1266 (343.27 seconds)
Valid loss at epoch 70 end: 0.1196
Train loss at epoch 70 end: 0.1317 (343.43 seconds)
Valid loss at epoch 71 end: 0.1184
Train loss at epoch 71 end: 0.1301 (343.90 seconds)
Valid loss at epoch 72 end: 0.1256
Train loss at epoch 72 end: 0.1278 (344.79 seconds)
Valid loss at epoch 73 end: 0.1204
Train loss at epoch 73 end: 0.1275 (345.11 seconds)
Valid loss at epoch 74 end: 0.1267
Train loss at epoch 74 end: 0.1276 (341.36 seconds)
Valid loss at epoch 75 end: 0.1196
Train loss at epoch 75 end: 0.1305 (342.21 seconds)
Valid loss at epoch 76 end: 0.1259
Train loss at epoch 76 end: 0.1281 (343.02 seconds)
Valid loss at epoch 77 end: 0.1231
Train loss at epoch 77 end: 0.1284 (342.94 seconds)
Valid loss at epoch 78 end: 0.1273
Train loss at epoch 78 end: 0.1293 (339.54 seconds)
Valid loss at epoch 79 end: 0.1347
Train loss at epoch 79 end: 0.1301 (344.21 seconds)
Valid loss at epoch 80 end: 0.1236
Train loss at epoch 80 end: 0.1277 (349.68 seconds)
Valid loss at epoch 81 end: 0.1313
Train loss at epoch 81 end: 0.1300 (345.81 seconds)
Valid loss at epoch 82 end: 0.1289
Train loss at epoch 82 end: 0.1279 (343.55 seconds)
Valid loss at epoch 83 end: 0.1168
Train loss at epoch 83 end: 0.1283 (340.21 seconds)
Valid loss at epoch 84 end: 0.1240
Train loss at epoch 84 end: 0.1277 (348.83 seconds)
Valid loss at epoch 85 end: 0.1197
Train loss at epoch 85 end: 0.1255 (345.40 seconds)
Valid loss at epoch 86 end: 0.1220
Train loss at epoch 86 end: 0.1249 (342.95 seconds)
Valid loss at epoch 87 end: 0.1147
Train loss at epoch 87 end: 0.1270 (346.63 seconds)
Valid loss at epoch 88 end: 0.1202
Train loss at epoch 88 end: 0.1243 (344.82 seconds)
Valid loss at epoch 89 end: 0.1257
Train loss at epoch 89 end: 0.1248 (343.43 seconds)
Valid loss at epoch 90 end: 0.1258
Train loss at epoch 90 end: 0.1262 (347.03 seconds)
Valid loss at epoch 91 end: 0.1252
Train loss at epoch 91 end: 0.1276 (342.13 seconds)
Valid loss at epoch 92 end: 0.1201
Train loss at epoch 92 end: 0.1278 (343.35 seconds)
Valid loss at epoch 93 end: 0.1227
Train loss at epoch 93 end: 0.1261 (343.35 seconds)
Valid loss at epoch 94 end: 0.1156
Train loss at epoch 94 end: 0.1257 (343.64 seconds)
Valid loss at epoch 95 end: 0.1251
Train loss at epoch 95 end: 0.1259 (344.73 seconds)
Valid loss at epoch 96 end: 0.1215
Train loss at epoch 96 end: 0.1246 (341.53 seconds)
Valid loss at epoch 97 end: 0.1240
Train loss at epoch 97 end: 0.1238 (342.70 seconds)
Valid loss at epoch 98 end: 0.1348
Train loss at epoch 98 end: 0.1245 (346.80 seconds)
Valid loss at epoch 99 end: 0.1248
Train loss at epoch 99 end: 0.1261 (344.32 seconds)
Valid loss at epoch 100 end: 0.1231
Train loss at epoch 100 end: 0.1245 (344.80 seconds)
Valid loss at epoch 101 end: 0.1214
Train loss at epoch 101 end: 0.1242 (341.92 seconds)
Valid loss at epoch 102 end: 0.1226
Train loss at epoch 102 end: 0.1222 (343.70 seconds)
Valid loss at epoch 103 end: 0.1250
Train loss at epoch 103 end: 0.1251 (342.38 seconds)
Valid loss at epoch 104 end: 0.1149
Train loss at epoch 104 end: 0.1273 (343.04 seconds)
Valid loss at epoch 105 end: 0.1238
Train loss at epoch 105 end: 0.1229 (343.03 seconds)
Valid loss at epoch 106 end: 0.1190
Train loss at epoch 106 end: 0.1275 (347.06 seconds)
Valid loss at epoch 107 end: 0.1348
Train loss at epoch 107 end: 0.1231 (343.97 seconds)
Valid loss at epoch 108 end: 0.1185
Train loss at epoch 108 end: 0.1273 (345.37 seconds)
Valid loss at epoch 109 end: 0.1150
Train loss at epoch 109 end: 0.1238 (342.81 seconds)
Valid loss at epoch 110 end: 0.1194
Train loss at epoch 110 end: 0.1244 (342.82 seconds)
Valid loss at epoch 111 end: 0.1245
Train loss at epoch 111 end: 0.1253 (343.23 seconds)
Valid loss at epoch 112 end: 0.1191
Train loss at epoch 112 end: 0.1270 (343.90 seconds)
Valid loss at epoch 113 end: 0.1201
Train loss at epoch 113 end: 0.1215 (341.54 seconds)
Valid loss at epoch 114 end: 0.1258
Train loss at epoch 114 end: 0.1256 (345.73 seconds)
Valid loss at epoch 115 end: 0.1288
Train loss at epoch 115 end: 0.1230 (343.23 seconds)
Valid loss at epoch 116 end: 0.1186
Train loss at epoch 116 end: 0.1280 (345.39 seconds)
Valid loss at epoch 117 end: 0.1171
Train loss at epoch 117 end: 0.1243 (343.05 seconds)
Valid loss at epoch 118 end: 0.1162
Train loss at epoch 118 end: 0.1260 (344.26 seconds)
Valid loss at epoch 119 end: 0.1205
Train loss at epoch 119 end: 0.1259 (343.78 seconds)
Valid loss at epoch 120 end: 0.1264
Train loss at epoch 120 end: 0.1238 (343.29 seconds)
Valid loss at epoch 121 end: 0.1205
Train loss at epoch 121 end: 0.1274 (342.67 seconds)
Valid loss at epoch 122 end: 0.1208
Train loss at epoch 122 end: 0.1240 (343.03 seconds)
Valid loss at epoch 123 end: 0.1343
Train loss at epoch 123 end: 0.1259 (348.48 seconds)
Valid loss at epoch 124 end: 0.1315
Train loss at epoch 124 end: 0.1246 (343.50 seconds)
Valid loss at epoch 125 end: 0.1218
Train loss at epoch 125 end: 0.1249 (347.84 seconds)
Valid loss at epoch 126 end: 0.1175
Train loss at epoch 126 end: 0.1228 (340.51 seconds)
Valid loss at epoch 127 end: 0.1200
Train loss at epoch 127 end: 0.1236 (345.52 seconds)
Valid loss at epoch 128 end: 0.1290
Train loss at epoch 128 end: 0.1220 (344.55 seconds)
Valid loss at epoch 129 end: 0.1220
Train loss at epoch 129 end: 0.1234 (344.69 seconds)
Valid loss at epoch 130 end: 0.1213
Train loss at epoch 130 end: 0.1218 (344.48 seconds)
Valid loss at epoch 131 end: 0.1245
Train loss at epoch 131 end: 0.1237 (340.69 seconds)
Valid loss at epoch 132 end: 0.1244
Train loss at epoch 132 end: 0.1204 (345.88 seconds)
Valid loss at epoch 133 end: 0.1227
Train loss at epoch 133 end: 0.1229 (350.69 seconds)
Valid loss at epoch 134 end: 0.1156
Train loss at epoch 134 end: 0.1211 (344.07 seconds)
Valid loss at epoch 135 end: 0.1194
Train loss at epoch 135 end: 0.1249 (343.73 seconds)
Valid loss at epoch 136 end: 0.1108
Train loss at epoch 136 end: 0.1240 (344.92 seconds)
Valid loss at epoch 137 end: 0.1146
Train loss at epoch 137 end: 0.1210 (343.80 seconds)
Valid loss at epoch 138 end: 0.1134
Train loss at epoch 138 end: 0.1245 (342.30 seconds)
Valid loss at epoch 139 end: 0.1123
Train loss at epoch 139 end: 0.1215 (343.42 seconds)
Valid loss at epoch 140 end: 0.1148
Train loss at epoch 140 end: 0.1219 (340.63 seconds)
Valid loss at epoch 141 end: 0.1235
Train loss at epoch 141 end: 0.1246 (341.04 seconds)
Valid loss at epoch 142 end: 0.1285
Train loss at epoch 142 end: 0.1218 (342.90 seconds)
Valid loss at epoch 143 end: 0.1179
Train loss at epoch 143 end: 0.1240 (348.95 seconds)
Valid loss at epoch 144 end: 0.1209
Train loss at epoch 144 end: 0.1221 (344.12 seconds)
Valid loss at epoch 145 end: 0.1182
Train loss at epoch 145 end: 0.1225 (343.07 seconds)
Valid loss at epoch 146 end: 0.1248
Train loss at epoch 146 end: 0.1222 (344.87 seconds)
Valid loss at epoch 147 end: 0.1270
Train loss at epoch 147 end: 0.1239 (342.42 seconds)
Valid loss at epoch 148 end: 0.1270
Train loss at epoch 148 end: 0.1192 (341.79 seconds)
Valid loss at epoch 149 end: 0.1217
Train loss at epoch 149 end: 0.1263 (344.37 seconds)
Valid loss at epoch 150 end: 0.1188
Train loss at epoch 150 end: 0.1246 (341.25 seconds)
Valid loss at epoch 151 end: 0.1277
Train loss at epoch 151 end: 0.1224 (340.64 seconds)
Valid loss at epoch 152 end: 0.1210
Train loss at epoch 152 end: 0.1254 (342.92 seconds)
Valid loss at epoch 153 end: 0.1164
Train loss at epoch 153 end: 0.1209 (349.63 seconds)
Valid loss at epoch 154 end: 0.1217
Train loss at epoch 154 end: 0.1212 (345.94 seconds)
Valid loss at epoch 155 end: 0.1116
Train loss at epoch 155 end: 0.1198 (340.63 seconds)
Valid loss at epoch 156 end: 0.1199
Train loss at epoch 156 end: 0.1218 (346.33 seconds)
Valid loss at epoch 157 end: 0.1212
Train loss at epoch 157 end: 0.1212 (344.20 seconds)
Valid loss at epoch 158 end: 0.1200
Train loss at epoch 158 end: 0.1220 (347.24 seconds)
Valid loss at epoch 159 end: 0.1236
Train loss at epoch 159 end: 0.1185 (344.19 seconds)
Valid loss at epoch 160 end: 0.1083
Train loss at epoch 160 end: 0.1243 (344.99 seconds)
Valid loss at epoch 161 end: 0.1223
Train loss at epoch 161 end: 0.1223 (348.57 seconds)
Valid loss at epoch 162 end: 0.1202
Train loss at epoch 162 end: 0.1227 (344.24 seconds)
Valid loss at epoch 163 end: 0.1221
Train loss at epoch 163 end: 0.1214 (344.09 seconds)
Valid loss at epoch 164 end: 0.1145
Train loss at epoch 164 end: 0.1232 (342.19 seconds)
Valid loss at epoch 165 end: 0.1188
Train loss at epoch 165 end: 0.1206 (343.52 seconds)
Valid loss at epoch 166 end: 0.1168
Train loss at epoch 166 end: 0.1221 (343.00 seconds)
Valid loss at epoch 167 end: 0.1287
Train loss at epoch 167 end: 0.1262 (344.89 seconds)
Valid loss at epoch 168 end: 0.1248
Train loss at epoch 168 end: 0.1237 (352.19 seconds)
Valid loss at epoch 169 end: 0.1274
Train loss at epoch 169 end: 0.1194 (346.30 seconds)
Valid loss at epoch 170 end: 0.1203
Train loss at epoch 170 end: 0.1220 (343.35 seconds)
Valid loss at epoch 171 end: 0.1242
Train loss at epoch 171 end: 0.1231 (345.23 seconds)
Valid loss at epoch 172 end: 0.1199
Train loss at epoch 172 end: 0.1216 (345.82 seconds)
Valid loss at epoch 173 end: 0.1178
Train loss at epoch 173 end: 0.1220 (343.94 seconds)
Valid loss at epoch 174 end: 0.1201
Train loss at epoch 174 end: 0.1213 (341.92 seconds)
